# üéØ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô Registration + Login ‡πÉ‡∏´‡∏°‡πà

## üìã **‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà (‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á User Account)**

### 1. ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ú‡πà‡∏≤‡∏ô Swagger UI

‡πÑ‡∏õ‡∏ó‡∏µ‡πà `http://localhost:8000/docs` ‚Üí `POST /api/v1/registration/`

```json
{
  "citizen_id": "1234567890123",
  "first_name": "‡∏™‡∏°‡∏ä‡∏≤‡∏¢",
  "last_name": "‡πÉ‡∏à‡∏î‡∏µ", 
  "email": "somchai@example.com",
  "phone": "0812345678",
  "date_of_birth": "1990-01-01T00:00:00",
  "password": "mypassword123",
  "address": "123 ‡∏ñ‡∏ô‡∏ô‡∏™‡∏∏‡∏Ç‡∏∏‡∏°‡∏ß‡∏¥‡∏ó",
  "province": "‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£",
  "district": "‡∏ß‡∏±‡∏í‡∏ô‡∏≤",
  "sub_district": "‡∏•‡∏∏‡∏°‡∏û‡∏¥‡∏ô‡∏µ",
  "postal_code": "10330",
  "target_provinces": ["‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà", "‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ"],
  "interests": ["‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥", "‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°"]
}
```

**üì§ Response:**
```json
{
  "id": 1,
  "user_id": 3,
  "citizen_id": "1234567890123",
  "first_name": "‡∏™‡∏°‡∏ä‡∏≤‡∏¢",
  "last_name": "‡πÉ‡∏à‡∏î‡∏µ",
  "email": "somchai@example.com",
  "status": "pending",
  "target_provinces": ["‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà", "‡∏Å‡∏≤‡∏ç‡∏à‡∏ô‡∏ö‡∏∏‡∏£‡∏µ"],
  "interests": ["‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥", "‡∏ß‡∏±‡∏í‡∏ô‡∏ò‡∏£‡∏£‡∏°"]
}
```

## üîê **‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö**

### 2. Login ‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô

‡πÑ‡∏õ‡∏ó‡∏µ‡πà `POST /api/v1/auth/login`

```json
{
  "username": "somchai@example.com",
  "password": "mypassword123"
}
```

**üì§ Response:**
```json
{
  "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
  "token_type": "bearer",
  "expires_in": 1800
}
```

## üéØ **‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô API ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á Authentication**

### 3. ‡πÉ‡∏ä‡πâ Token ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á Protected Endpoints

‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å `access_token` ‡∏à‡∏≤‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô 2 ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏•‡∏¥‡∏Å **"Authorize"** ‡πÉ‡∏ô Swagger UI

‡πÉ‡∏™‡πà: `Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...`

‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ API ‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÑ‡∏î‡πâ:

- ‚úÖ `PUT /api/v1/registration/{id}` - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
- ‚úÖ `POST /api/v1/auth/logout` - ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö

## üë• **User Roles**

| Role | ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå |
|------|--------|
| **USER** (‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà) | - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á<br>- ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î<br>- ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏•‡∏î‡∏´‡∏¢‡πà‡∏≠‡∏ô‡∏†‡∏≤‡∏©‡∏µ |
| **ADMIN** | - ‡∏ó‡∏∏‡∏Å‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Ç‡∏≠‡∏á USER<br>- ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ Registration ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î<br>- ‡∏•‡∏ö Registration<br>- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î<br>- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏†‡∏≤‡∏©‡∏µ |

## üîÑ **‡∏Å‡∏≤‡∏£ Migrate ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°**

‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Registration ‡πÄ‡∏î‡∏¥‡∏°‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ô‡∏µ‡πâ:

```bash
python scripts/migrate_add_user_id.py
```

**‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô:**
- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå `user_id` ‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á registration
- ‡∏™‡∏£‡πâ‡∏≤‡∏á User Account ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Registration ‡πÄ‡∏î‡∏¥‡∏°
- ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô: `123456`
- ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ login ‡∏î‡πâ‡∏ß‡∏¢‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô `123456` ‡πÑ‡∏î‡πâ

## üìù **‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Login ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î**

| ‡∏≠‡∏µ‡πÄ‡∏°‡∏• | ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô | Role | ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ |
|-------|----------|------|----------|
| `admin@thaitour.com` | `secret` | ADMIN | Admin ‡πÄ‡∏î‡∏¥‡∏° |
| `user@thaitour.com` | `secret` | USER | User ‡πÄ‡∏î‡∏¥‡∏° |
| `somchai@example.com` | `mypassword123` | USER | ‡∏ú‡∏π‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà |
| `(registration ‡πÄ‡∏î‡∏¥‡∏°)` | `123456` | USER | Registration ‡πÄ‡∏î‡∏¥‡∏°‡∏´‡∏•‡∏±‡∏á migrate |

## üéâ **‡∏™‡∏£‡∏∏‡∏õ**

‚úÖ **‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡∏°‡πà** ‚Üí ‡∏™‡∏£‡πâ‡∏≤‡∏á User Account ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‚Üí Login ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ

‚úÖ **‡πÄ‡∏õ‡πá‡∏ô User Role** ‚Üí ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á API ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á Authentication

‚úÖ **‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏¥‡∏°** ‚Üí Migration script ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ
